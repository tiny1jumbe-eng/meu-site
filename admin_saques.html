<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Saques</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background:#111; color:#fff; margin:0; font-family:Arial,sans-serif; }
    header { background:#000; color:red; padding:15px; text-align:center; font-size:20px; }
    table { width:95%; margin:20px auto; border-collapse:collapse; background:#222; }
    th,td { border:1px solid #333; padding:10px; text-align:center; }
    th { background:#000; color:red; }
    .btn-aprovar { background:green; color:#fff; padding:6px 10px; border:none; cursor:pointer; border-radius:5px; }
    .btn-recusar { background:red; color:#fff; padding:6px 10px; border:none; cursor:pointer; border-radius:5px; }
  </style>
</head>
<body>
  <header>üì§ Solicita√ß√µes de Saque</header>

  <table>
    <thead>
      <tr>
        <th>Usu√°rio</th>
        <th>Valor solicitado</th>
        <th>Taxa aplicada</th>
        <th>Valor l√≠quido</th>
        <th>Status</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="tabelaSaques"></tbody>
  </table>

<script>
  // Simula√ß√£o de saques pendentes
  const saquesPendentes = [
    { usuario: "Maria", valor: 500, status:"Pendente" },
    { usuario: "Jo√£o", valor: 2500, status:"Pendente" },
    { usuario: "Carlos", valor: 12000, status:"Pendente" }
  ];

  /**
   * Regras de taxa (decrescentes):
   * 100 a 999 MZN  -> 10%
   * 1.000 a 10.000 -> 7%
   * > 10.000       -> 5%
   * Abaixo de 100  -> 0% (sem taxa)
   */
  function calcularTaxa(valor){
    if(valor >= 100 && valor <= 999){
      return { taxa: 0.10, percentual: "10%" };
    } else if(valor >= 1000 && valor <= 10000){
      return { taxa: 0.07, percentual: "7%" };
    } else if(valor > 10000){
      return { taxa: 0.05, percentual: "5%" };
    } else {
      return { taxa: 0, percentual: "0%" };
    }
  }

  function atualizarTabela(){
    document.getElementById("tabelaSaques").innerHTML = saquesPendentes.map((s, index)=>{
      const { taxa, percentual } = calcularTaxa(s.valor);
      const valorLiquido = s.valor - (s.valor * taxa);
      return `
        <tr>
          <td>${s.usuario}</td>
          <td>${s.valor} MZN</td>
          <td>${percentual}</td>
          <td>${valorLiquido.toFixed(2)} MZN</td>
          <td id="status-${index}">${s.status}</td>
          <td>
            <button class="btn-aprovar" onclick="aprovar(${index})">Aprovar</button>
            <button class="btn-recusar" onclick="recusar(${index})">Recusar</button>
          </td>
        </tr>
      `;
    }).join("");
  }

  function aprovar(i){
    saquesPendentes[i].status = "Aprovado ‚úÖ";
    atualizarTabela();
    adicionarNotificacao(`Saque de ${saquesPendentes[i].usuario} aprovado.`);
  }

  function recusar(i){
    saquesPendentes[i].status = "Recusado ‚ùå";
    atualizarTabela();
    adicionarNotificacao(`Saque de ${saquesPendentes[i].usuario} recusado.`);
  }

  // Envia notifica√ß√£o para o dashboard (via localStorage)
  function adicionarNotificacao(msg){
    let notificacoes = JSON.parse(localStorage.getItem("notificacoes")) || [];
    notificacoes.push("üì¢ " + msg);
    localStorage.setItem("notificacoes", JSON.stringify(notificacoes));
  }

  atualizarTabela();
</script>
</body>
</html>
