<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DIGIVEND - Mercado de Afilia√ß√£o</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- TOPO -->
  <header class="dashboard-header">
    <button class="menu-btn" onclick="openMenu()" aria-label="Abrir menu">‚ò∞</button>
    <h1 class="logo-center">DIGIVEND</h1>
    <div class="user-profile">üë§ Usu√°rio</div>
  </header>

  <!-- MENU LATERAL -->
  <nav id="sideMenu" class="side-menu">
    <button class="close-btn" onclick="closeMenu()">√ó</button>
    <a href="dashboard_vendedor.html" onclick="closeMenu()">Home</a>
    <a href="meus_produtos.html" onclick="closeMenu()">Meus Produtos</a>
    <a href="vendas.html" onclick="closeMenu()">Vendas</a>
    <a href="analises.html" onclick="closeMenu()">An√°lises/Relat√≥rios</a>
    <a href="saldo.html" onclick="closeMenu()">Saldo</a>
    <a href="digiclub.html" onclick="closeMenu()">Digiclub</a>
    <a href="mercado_afiliacao.html" onclick="closeMenu()">Mercado de Afilia√ß√£o</a>
    <a href="ferramentas.html" onclick="closeMenu()">Ferramentas</a>
    <a href="chat_afiliados.html" onclick="closeMenu()">Chat Afiliados</a>
  </nav>

  <!-- CONTE√öDO -->
  <main class="dashboard-content" style="padding:16px; margin-top:12px;">
    <h2 class="logo-center" style="color:red;">Mercado de Afilia√ß√£o</h2>

    <section id="listaProdutos" class="cards-container" style="margin-top:20px; display:flex; flex-wrap:wrap; gap:16px; justify-content:center;">
      <p>Carregando produtos...</p>
    </section>
  </main>

  <script>
    function openMenu(){ document.getElementById('sideMenu').style.width = '250px'; }
    function closeMenu(){ document.getElementById('sideMenu').style.width = '0'; }

    const API = "http://localhost:3000";

    // Buscar produtos
    fetch(API + "/produtos")
      .then(res => res.json())
      .then(produtos => {
        let container = document.getElementById("listaProdutos");
        container.innerHTML = "";
        produtos.forEach(p => {
          container.innerHTML += `
            <div class="card" style="width:250px; text-align:center; padding:16px; background:#111; border-radius:8px;">
              <img src="${p.imagem}" alt="${p.nome}" style="width:100%; height:150px; object-fit:cover; border-radius:8px;">
              <h3 style="color:white; margin:10px 0;">${p.nome}</h3>
              <p style="color:gray;">${p.descricao}</p>
              <p style="color:red; font-weight:bold; margin:8px 0;">R$ ${p.preco}</p>
              <div style="display:flex; justify-content:center; gap:8px; flex-wrap:wrap;">
                <button onclick="comprarProduto('${p.nome}')" style="padding:8px 14px; background:green; border:none; color:white; border-radius:6px; cursor:pointer;">Comprar</button>
                ${p.afiliacao ? `<button onclick="afiliarProduto('${p.nome}', '${p.comissao}')" style="padding:8px 14px; background:red; border:none; color:white; border-radius:6px; cursor:pointer;">Afiliar (${p.comissao}%)</button>` : ""}
              </div>
              <p style="color:gray; margin-top:6px;">Afiliados: ${p.afiliados || 0} | Vendas: ${p.vendasAfiliados || 0}</p>
            </div>
          `;
        });
      });

    function comprarProduto(nome){
      alert("üõí Voc√™ comprou o produto: " + nome);
    }

    function afiliarProduto(nome, comissao){
      let email = prompt("Digite seu email v√°lido:");
      let telefone = prompt("Digite seu n√∫mero de telefone:");
      if(email && telefone){
        alert("‚úÖ Voc√™ se afiliou ao produto " + nome + " com comiss√£o de " + comissao + "%.\nEntraremos em contato pelo email: " + email);
      } else {
        alert("‚ùå Preencha os dados corretamente para se afiliar.");
      }
    }
  </script>
</body>
</html>
