<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meu Digiclub - DIGIVEND</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- TOPO -->
  <header class="dashboard-header">
    <button class="menu-btn" onclick="openMenu()">‚ò∞</button>
    <h1 class="logo-center">DIGIVEND</h1>
    <div class="user-profile">üë§ Usu√°rio</div>
  </header>

  <!-- MENU LATERAL -->
  <nav id="sideMenu" class="side-menu">
    <button class="close-btn" onclick="closeMenu()">√ó</button>
    <a href="dashboard_vendedor.html" onclick="closeMenu()">Home</a>
    <a href="meus_produtos.html" onclick="closeMenu()">Meus Produtos</a>
    <a href="vendas.html" onclick="closeMenu()">Vendas</a>
    <a href="analises.html" onclick="closeMenu()">An√°lises/Relat√≥rios</a>
    <a href="saldo.html" onclick="closeMenu()">Saldo</a>
    <a href="digiclub.html" onclick="closeMenu()">Digiclub</a>
    <a href="mercado_afiliacao.html" onclick="closeMenu()">Mercado de Afilia√ß√£o</a>
    <a href="ferramentas.html" onclick="closeMenu()">Ferramentas</a>
    <a href="chat_afiliados.html" onclick="closeMenu()">Chat Afiliados</a>
  </nav>

  <!-- CONTE√öDO -->
  <main class="dashboard-content" style="padding:16px;">

    <!-- Progresso -->
    <div style="display:flex; align-items:center; justify-content:center; margin-top:20px;">
      <!-- C√≠rculo -->
      <div style="position:relative; width:100px; height:100px;">
        <svg width="100" height="100">
          <circle cx="50" cy="50" r="45" stroke="#333" stroke-width="10" fill="none"/>
          <circle id="progressCircle" cx="50" cy="50" r="45" stroke="red" stroke-width="10" fill="none" stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round"/>
        </svg>
        <div id="progressText" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:18px; font-weight:bold; color:white;">0%</div>
      </div>

      <!-- Texto ao lado -->
      <div style="margin-left:20px; font-size:16px; color:white;">
        Primeiros passos para personaliza√ß√£o b√°sica
      </div>
    </div>

    <!-- Bot√µes -->
    <div style="text-align:center; margin-top:20px;">
      <a href="adicionar_produtos.html"><button class="btn-vermelho">Adicionar primeiros produtos</button></a>
      <a href="personalizar_digiclub.html"><button class="btn-vermelho">Personalizar Digiclub</button></a>
      <a href="criar_comunidade.html"><button class="btn-vermelho">Criar primeira comunidade</button></a>
    </div>

    <!-- Lista de Comunidades -->
    <section style="margin-top:30px; text-align:center; color:white;">
      <h3 style="color:red;">Minhas Comunidades</h3>
      <ul id="listaComunidades" style="list-style:none; padding:0; margin-top:10px;"></ul>
    </section>

    <!-- Lista de Produtos -->
    <section style="margin-top:30px; text-align:center; color:white;">
      <h3 style="color:red;">Meus Produtos</h3>
      <ul id="listaProdutos" style="list-style:none; padding:0; margin-top:10px;"></ul>
    </section>

  </main>

  <script>
    function openMenu(){ document.getElementById('sideMenu').style.width = '250px'; }
    function closeMenu(){ document.getElementById('sideMenu').style.width = '0'; }

    // -------- L√ìGICA LOCALSTORAGE --------
    function atualizarProgresso() {
      let progresso = 0;
      if (localStorage.getItem("produtos") && JSON.parse(localStorage.getItem("produtos")).length > 0) progresso += 33;
      if (localStorage.getItem("personalizado") === "true") progresso += 33;
      if (localStorage.getItem("comunidades") && JSON.parse(localStorage.getItem("comunidades")).length > 0) progresso += 34;

      const circle = document.getElementById("progressCircle");
      const text = document.getElementById("progressText");
      const offset = 283 - (283 * progresso) / 100;

      circle.style.strokeDashoffset = offset;
      text.textContent = progresso + "%";
    }

    function carregarListas() {
      const listaProdutos = document.getElementById("listaProdutos");
      const listaComunidades = document.getElementById("listaComunidades");

      listaProdutos.innerHTML = "";
      listaComunidades.innerHTML = "";

      let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");

      // Produtos
      if (produtos.length === 0) {
        listaProdutos.innerHTML = `<li style="background:#111; margin:10px auto; padding:10px; border-radius:6px; max-width:500px;">Nenhum produto adicionado ainda.</li>`;
      } else {
        produtos.forEach((p, index) => {
          listaProdutos.innerHTML += `
            <li style="background:#111; margin:10px auto; padding:10px; border-radius:6px; max-width:500px; display:flex; justify-content:space-between; align-items:center;">
              üì¶ ${p}
              <span>
                <button onclick="editarProduto(${index})" style="margin-right:5px;">‚úèÔ∏è</button>
                <button onclick="excluirProduto(${index})">üóëÔ∏è</button>
              </span>
            </li>`;
        });
      }

      // Comunidades
      if (comunidades.length === 0) {
        listaComunidades.innerHTML = `<li style="background:#111; margin:10px auto; padding:10px; border-radius:6px; max-width:500px;">Nenhuma comunidade criada ainda.</li>`;
      } else {
        comunidades.forEach((c, index) => {
          listaComunidades.innerHTML += `
            <li style="background:#111; margin:10px auto; padding:10px; border-radius:6px; max-width:500px; display:flex; justify-content:space-between; align-items:center;">
              üë• ${c}
              <span>
                <button onclick="editarComunidade(${index})" style="margin-right:5px;">‚úèÔ∏è</button>
                <button onclick="excluirComunidade(${index})">üóëÔ∏è</button>
              </span>
            </li>`;
        });
      }
    }

    // Fun√ß√µes Produtos
    function editarProduto(index) {
      let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");
      let novoNome = prompt("Editar nome do produto:", produtos[index]);
      if (novoNome) {
        produtos[index] = novoNome;
        localStorage.setItem("produtos", JSON.stringify(produtos));
        carregarListas();
        atualizarProgresso();
      }
    }

    function excluirProduto(index) {
      let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");
      produtos.splice(index, 1);
      localStorage.setItem("produtos", JSON.stringify(produtos));
      carregarListas();
      atualizarProgresso();
    }

    // Fun√ß√µes Comunidades
    function editarComunidade(index) {
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      let novoNome = prompt("Editar nome da comunidade:", comunidades[index]);
      if (novoNome) {
        comunidades[index] = novoNome;
        localStorage.setItem("comunidades", JSON.stringify(comunidades));
        carregarListas();
        atualizarProgresso();
      }
    }

    function excluirComunidade(index) {
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      comunidades.splice(index, 1);
      localStorage.setItem("comunidades", JSON.stringify(comunidades));
      carregarListas();
      atualizarProgresso();
    }

    // Inicializa√ß√£o
    document.addEventListener("DOMContentLoaded", () => {
      carregarListas();
      atualizarProgresso();
    });
  </script>
</body>
</html>
