<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meu Digiclub</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .btn { padding:6px 10px; border:none; border-radius:6px; cursor:pointer; }
    .btn-red { background:red; color:white; }
    .btn-gray { background:#444; color:white; }
    .btn-small { font-size:14px; margin-left:4px; }
    li { list-style:none; }
  </style>
</head>
<body>
  <!-- TOPO -->
  <header class="dashboard-header">
    <button class="menu-btn" onclick="openMenu()" aria-label="Abrir menu">‚ò∞</button>
    <h1 class="logo-center">DIGIVEND</h1>
    <div class="user-profile">üë§ Usu√°rio</div>
  </header>

  <!-- MENU LATERAL -->
  <nav id="sideMenu" class="side-menu">
    <button class="close-btn" onclick="closeMenu()">√ó</button>
    <a href="dashboard_vendedor.html" onclick="closeMenu()">Home</a>
    <a href="meus_produtos.html" onclick="closeMenu()">Meus Produtos</a>
    <a href="vendas.html" onclick="closeMenu()">Vendas</a>
    <a href="analises.html" onclick="closeMenu()">An√°lises/Relat√≥rios</a>
    <a href="saldo.html" onclick="closeMenu()">Saldo</a>
    <a href="digiclub.html" onclick="closeMenu()">Digiclub</a>
    <a href="mercado_afiliacao.html" onclick="closeMenu()">Mercado de Afilia√ß√£o</a>
    <a href="ferramentas.html" onclick="closeMenu()">Ferramentas</a>
    <a href="chat_afiliados.html" onclick="closeMenu()">Chat Afiliados</a>
  </nav>

  <!-- CONTE√öDO -->
  <main class="dashboard-content" style="padding:16px; margin-top:12px;">
    <h2 class="logo-center" style="color:red;">Meu Digiclub</h2>

    <!-- Barra de progresso -->
    <div style="display:flex; align-items:center; justify-content:center; margin:20px 0;">
      <svg width="80" height="80">
        <circle cx="40" cy="40" r="36" stroke="#444" stroke-width="6" fill="none"/>
        <circle id="progressCircle" cx="40" cy="40" r="36" stroke="red" stroke-width="6" fill="none"
          stroke-dasharray="226" stroke-dashoffset="226" transform="rotate(-90 40 40)"/>
      </svg>
      <div style="margin-left:12px;">
        <strong>Primeiros passos para personaliza√ß√£o b√°sica</strong>
        <p id="progressText">0% conclu√≠do</p>
      </div>
    </div>

    <!-- Bot√µes principais -->
    <div style="text-align:center; margin-bottom:24px;">
      <button class="btn btn-red" onclick="adicionarProduto()">‚ûï Adicionar primeiros produtos</button><br/><br/>
      <button class="btn btn-red" onclick="personalizar()">üé® Personalizar Digiclub</button><br/><br/>
      <button class="btn btn-red" onclick="criarComunidade()">üë• Criar primeira comunidade</button>
    </div>

    <!-- Listas -->
    <section>
      <h3 style="color:red; margin-top:16px;">Comunidades Criadas</h3>
      <ul id="listaComunidades"></ul>
    </section>

    <section>
      <h3 style="color:red; margin-top:16px;">Produtos no Digiclub</h3>
      <ul id="listaProdutos"></ul>
    </section>
  </main>

  <script>
    // MENU
    function openMenu(){ document.getElementById('sideMenu').style.width = '250px'; }
    function closeMenu(){ document.getElementById('sideMenu').style.width = '0'; }

    // Fun√ß√µes principais
    function adicionarProduto(){
      window.location.href = "meus_produtos.html";
    }

    function personalizar(){
      window.location.href = "personalizar_digiclub.html";
    }

    function criarComunidade(){
      const nome = prompt("Digite o nome da nova comunidade:");
      if(nome){
        let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
        comunidades.push(nome);
        localStorage.setItem("comunidades", JSON.stringify(comunidades));
        atualizarProgresso();
        carregarListas();
      }
    }

    function entrarComunidade(nome){
      localStorage.setItem("comunidadeAtual", nome);
      window.location.href = "comunidade.html";
    }

    function editarComunidade(index){
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      const novoNome = prompt("Novo nome da comunidade:", comunidades[index]);
      if(novoNome){
        comunidades[index] = novoNome;
        localStorage.setItem("comunidades", JSON.stringify(comunidades));
        carregarListas();
      }
    }

    function excluirComunidade(index){
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      if(confirm("Tem certeza que deseja excluir esta comunidade?")){
        comunidades.splice(index,1);
        localStorage.setItem("comunidades", JSON.stringify(comunidades));
        carregarListas();
      }
    }

    // Listas
    function carregarListas(){
      const listaComunidades = document.getElementById("listaComunidades");
      const listaProdutos = document.getElementById("listaProdutos");

      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");

      listaComunidades.innerHTML = "";
      if(comunidades.length === 0){
        listaComunidades.innerHTML = `<li style="background:#111; padding:10px; margin:8px 0; border-radius:6px;">Nenhuma comunidade criada ainda.</li>`;
      } else {
        comunidades.forEach((c,index)=>{
          listaComunidades.innerHTML += `
            <li style="background:#111; padding:10px; margin:8px 0; border-radius:6px; display:flex; justify-content:space-between; align-items:center;">
              <span>üë• ${c}</span>
              <span>
                <button class="btn btn-gray btn-small" onclick="entrarComunidade('${c}')">üö™ Entrar</button>
                <button class="btn btn-gray btn-small" onclick="editarComunidade(${index})">‚úèÔ∏è</button>
                <button class="btn btn-gray btn-small" onclick="excluirComunidade(${index})">üóëÔ∏è</button>
              </span>
            </li>`;
        });
      }

      listaProdutos.innerHTML = "";
      if(produtos.length === 0){
        listaProdutos.innerHTML = `<li style="background:#111; padding:10px; margin:8px 0; border-radius:6px;">Nenhum produto adicionado ainda.</li>`;
      } else {
        produtos.forEach((p)=>{
          listaProdutos.innerHTML += `
            <li style="background:#111; padding:10px; margin:8px 0; border-radius:6px;">
              üì¶ ${p}
            </li>`;
        });
      }
    }

    // Progresso
    function atualizarProgresso(){
      let progresso = 0;
      let comunidades = JSON.parse(localStorage.getItem("comunidades") || "[]");
      let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");
      let personalizado = localStorage.getItem("digiclubPersonalizado");

      if(produtos.length > 0) progresso += 33;
      if(personalizado) progresso += 33;
      if(comunidades.length > 0) progresso += 34;

      document.getElementById("progressText").innerText = progresso + "% conclu√≠do";

      const circle = document.getElementById("progressCircle");
      const totalLength = 226; 
      const offset = totalLength - (progresso/100 * totalLength);
      circle.style.strokeDashoffset = offset;
    }

    // Inicializa√ß√£o
    window.onload = function(){
      carregarListas();
      atualizarProgresso();
    }
  </script>
</body>
</html>
