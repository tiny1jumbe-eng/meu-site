<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DIGIVEND - Saldo</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- TOPO -->
  <header class="dashboard-header">
    <button class="menu-btn" onclick="openMenu()" aria-label="Abrir menu">☰</button>
    <h1 class="logo-center">DIGIVEND</h1>
    <div class="user-profile">👤 Usuário</div>
  </header>

  <!-- MENU LATERAL -->
  <nav id="sideMenu" class="side-menu">
    <button class="close-btn" onclick="closeMenu()">×</button>
    <a href="dashboard_vendedor.html" onclick="closeMenu()">Home</a>
    <a href="meus_produtos.html" onclick="closeMenu()">Meus Produtos</a>
    <a href="vendas.html" onclick="closeMenu()">Vendas</a>
    <a href="analises.html" onclick="closeMenu()">Análises/Relatórios</a>
    <a href="saldo.html" onclick="closeMenu()">Saldo</a>
    <a href="digiclub.html" onclick="closeMenu()">Digiclub</a>
    <a href="mercado_afiliacao.html" onclick="closeMenu()">Mercado de Afiliação</a>
    <a href="ferramentas.html" onclick="closeMenu()">Ferramentas</a>
    <a href="chat_afiliados.html" onclick="closeMenu()">Chat Afiliados</a>
  </nav>

  <!-- CONTEÚDO -->
  <main class="dashboard-content" style="padding:16px; margin-top:12px;">
    <h2 class="logo-center" style="color:red;">Saldo</h2>

    <!-- Cards Resumo -->
    <section class="cards-container" style="margin-top:16px;">
      <div class="card"><h3>💰 Saldo Disponível</h3><p id="saldoDisponivel">Carregando...</p></div>
      <div class="card"><h3>⏳ Saldo Pendente</h3><p id="saldoPendente">Carregando...</p></div>
      <div class="card"><h3>📤 Saques Realizados</h3><p id="saques">Carregando...</p></div>
      <div class="card"><h3>💵 Total de Ganhos</h3><p id="ganhos">Carregando...</p></div>
    </section>

    <!-- Botão de Saque -->
    <div style="text-align:center; margin:24px 0;">
      <button id="btnSaque" class="btn-vermelho" style="padding:12px 20px; font-size:16px; border:none; border-radius:8px; background:red; color:white; cursor:pointer;">
        Solicitar Saque
      </button>
    </div>

    <!-- Histórico de Transações -->
    <h2 class="logo-center" style="color:red; margin-top:24px;">Histórico de Transações</h2>
    <table id="tabelaTransacoes" class="product-table" style="width:95%; max-width:1000px; margin:0 auto; border-collapse:collapse; background:#111; color:#fff; border-radius:8px; overflow:hidden; margin-top:16px;">
      <thead>
        <tr>
          <th style="background:#222; color:red; padding:10px; border:1px solid #333;">Data</th>
          <th style="background:#222; color:red; padding:10px; border:1px solid #333;">Produto</th>
          <th style="background:#222; color:red; padding:10px; border:1px solid #333;">Valor</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="3" style="padding:10px; text-align:center;">Carregando...</td></tr>
      </tbody>
    </table>
  </main>

  <script>
    function openMenu(){ document.getElementById('sideMenu').style.width = '250px'; }
    function closeMenu(){ document.getElementById('sideMenu').style.width = '0'; }

    // 🔥 Conectar ao JSON Server
    const API = "http://localhost:3000";

    // Atualizar saldo
    fetch(API + "/saldo")
      .then(res => res.json())
      .then(data => {
        document.getElementById('saldoDisponivel').innerText = "R$ " + data.disponivel;
        document.getElementById('saldoPendente').innerText = "R$ " + data.pendente;
        document.getElementById('saques').innerText = "R$ " + data.saques;
        document.getElementById('ganhos').innerText = "R$ " + data.ganhos;
      });

    // Carregar histórico de vendas
    fetch(API + "/vendas")
      .then(res => res.json())
      .then(vendas => {
        let tbody = document.querySelector("#tabelaTransacoes tbody");
        tbody.innerHTML = "";
        vendas.forEach(v => {
          tbody.innerHTML += `
            <tr>
              <td style="padding:10px; border:1px solid #333; text-align:center;">${v.data}</td>
              <td style="padding:10px; border:1px solid #333; text-align:center;">${v.produto}</td>
              <td style="padding:10px; border:1px solid #333; text-align:center;">R$ ${v.valor}</td>
            </tr>`;
        });
      });

    // Função para solicitar saque
    document.getElementById("btnSaque").addEventListener("click", () => {
      alert("💸 Solicitação de saque enviada com sucesso!");
    });
  </script>
</body>
</html>
